Here’s a **Documentation cum User Guide** template for your code handover. You can copy this into a `.md` or `.docx` file and adjust any descriptions or filenames as needed.

---

# 📦 Codebase Documentation and User Guide

**Project:** Radar and OGI JSON + Excel Generator
**Prepared for Handover by:** Rutik Torambe
**Date:** \[Insert Date]

---

## ✅ Overview

This system is designed to:

1. Generate **Radar Batch JSON** from Excel input using a Mapping document.
2. Generate **Radar Excel** files from the created Radar JSON.
3. Create **OGI JSON** from Radar JSON.
4. Generate **OGI and TGSL Excel** files from OGI JSON.

---

## 📁 Input Files and Their Roles

### 1. **Mapping Document (Excel Sheet)**

- Sheet contains fields that define the maximum structure of the JSON output.
- Columns:

  - `Section`
  - `NodeNo`
  - `VariableName`
  - `PathJson`
  - `DataType`
  - `SR No`
  - `Comments`

- Used to define the **structure**, **data type**, and **mapping path** for JSON.

### 2. **Data Workbook**

- One or more sheets containing the actual input data.
- Can be concatenated into a single DataFrame.
- Column names in data **do not** match JSON variable names.
- We use `SR No` to perform the mapping between mapping sheet and data sheet.

### 3. **Pricing Specification Workbook**

- Used for enrichment (ABI Code lookup, Broker grouping, etc.).
- Sheets used:

  - `VehicleEnrich`
  - `BrokerGroupingSheet`
  - `ParkingGroupSheet`

### 4. **postcode.txt**

- A text file used for looking up `CompRel` values based on postcode.
- Converted to CSV for processing.

---

## ⚙️ Code Workflow

### Step 1: 🔧 **Create Batch JSON for Radar**

#### Function: `create_radar_batch_json()`

- Merges the input data with mapping sheet using `SR No`.
- Builds a list of JSON objects based on `PathJSON`.
- Applies maximum nodes (e.g., max 4 drivers) using Mapping Document.

---

### Step 2: 🛠️ **Apply Transformations to JSON**

Below transformations are applied in sequence:

| Transformation Function             | Description                                                                                                      |
| ----------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| `trim_drivers_based_on_cover()`     | Trims empty Driver nodes. Driver count is trimmed to `min = 1`, `max = 4` as per Cover section.                  |
| `trim_occupations()`                | Trims empty Occupation nodes inside Driver. Min/max logic: 2 for Driver 1, 1–2 for others.                       |
| `vehicle_modifications()`           | Removes empty `modification` nodes.                                                                              |
| `toggle_part_time()`                | Converts `FullTime` flag from data to JSON `PartTime`. If `FullTime` is true → `PartTime = false`.               |
| `enrich_quotes_with_vehicle_data()` | Looks up `ABICode` and `OverNightParkingID` to enrich vehicle data from Pricing Specification workbook.          |
| `BrokerGrouping_POSTCODE_CompRel()` | Enriches `CompRel` using postcode (from `postcode.txt`) and `BrokerGroup` using lookup in `BrokerGroupingSheet`. |
| `overwrite_proposer_occupations()`  | Overwrites proposer occupations using Driver with `DriverRelProposer = "P"`.                                     |
| `RemoveNulls()`                     | Cleans out empty/blank `InsurerRatingFactor` fields.                                                             |
| `DefaultValues()`                   | Adds constants: `DataSourceID`, `BrokerSourceOfBusinessID`, `CategoryTypeID`, `Capstone1`, `Capstone3`.          |
| `RefID()`                           | Adds reference IDs (`RefID`) to each node (Drivers, Modifications, Occupations, IRF, Claims, Conversions).       |

---

### Step 3: 📄 **Create Radar Excel File**

#### Function: `create_radar_excel_from_json()`

- Converts final transformed Radar JSON into Excel.
- Each JSON object → separate sheet in the Excel workbook.
- Sheet name follows a naming convention (e.g., Quote_1, Quote_2, ...).

---

### Step 4: 🧾 **Create OGI JSON**

#### Function: `create_ogi_json_from_radar_json()`

- Transforms Radar JSON into OGI format.
- Follows similar mapping technique but OGI schema differs from Radar.
- Uses business rules and additional lookups.

---

### Step 5: 📑 **Create OGI + TGSL Excel Files**

#### Function: `create_ogi_tgsl_excel_from_ogi_json()`

- Extracts and flattens OGI JSON into Excel.
- Generates two sheets:

  - `OGI_Data`
  - `TGSL_Data`

- Includes transformed and lookup-enriched fields.

---

## 🧪 Testing & Validation

- **Unit Test Files:** \[Add paths or mention if available]
- **Sample Inputs:** Located in `/input_samples`
- **Expected Outputs:** Located in `/expected_outputs`
- Run `main.py` or `run_pipeline.py` to execute the complete pipeline.

---

## 🔐 Credentials and Configs

- No credentials used directly in the code.
- Lookup sheets and text files must exist in expected directories:

  - `pricing_spec.xlsx`
  - `postcode.txt`

---

## 🗂 Folder Structure

```
project/
│
├── main.py
├── mapping/
│   └── mapping.xlsx
├── input_data/
│   ├── workbook1.xlsx
│   └── pricing_spec.xlsx
├── postcode/
│   └── postcode.txt
├── output/
│   ├── radar_batch.json
│   ├── radar_excel.xlsx
│   ├── ogi.json
│   └── ogi_tgsl.xlsx
└── utils/
    ├── transformation.py
    ├── enrichment.py
    └── json_generator.py
```

---

## 🧾 Final Deliverables

| File               | Description                                       |
| ------------------ | ------------------------------------------------- |
| `radar_batch.json` | Final JSON batch with all transformations applied |
| `radar_excel.xlsx` | Excel version of Radar JSON                       |
| `ogi.json`         | Final OGI JSON                                    |
| `ogi_tgsl.xlsx`    | Excel file with OGI and TGSL data                 |

---

Let me know if you want this saved as a `.docx`, `.md`, or `.pdf` format. I can also help generate a template with placeholders for easier editing.
